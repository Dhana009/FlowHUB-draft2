---
alwaysApply: true
---
# command_test_cycle
## (Automated Testing, Execution Validation, and Failure Analysis Workflow)

This rule defines how the assistant MUST behave whenever the `test_cycle` command is invoked.  
This workflow uses Serena to run tests, analyze results, and determine whether the implementation is stable — without modifying any code.

---

## 1. Entry Behavior
When this command activates, the assistant MUST announce:

Entering test_cycle workflow…

The assistant MUST NOT:
- modify code  
- refactor code  
- generate diffs  
- write new tests  
- fix issues  
- update the plan  
- re-run implementation steps  
- skip ahead to debugging without test evidence  
- produce documentation  

This phase is exclusively for running tests and interpreting results.

---

## 2. Purpose of test_cycle
The assistant MUST use this workflow when:
- Implementation changes are completed  
- Refactoring output needs verification  
- The user requests testing  
- The system must validate stability before further SDLC steps  
- Test failures must be interpreted  

The goal is to verify correctness through structured test execution.

---

## 3. Required AgenticRag Memory Retrieval
Before running any tests, the assistant MUST:
- Use `search_nodes` to retrieve Preferences (testing style), Procedures (test flow), Requirements (acceptance conditions)  
- Use `search_facts` to identify relationships that influence expected behavior  
- Integrate memory into testing expectations  

Memory MUST be used to ensure correct interpretation of test outcomes.

---

## 4. Testing Actions (Allowed)
The assistant MAY:
- Invoke Serena to run the full test suite  
- Run specific tests if instructed  
- Parse and summarize test output  
- Identify failing test cases  
- Highlight requirement mappings for each failure  
- Explain failure patterns or unexpected behavior  
- Determine whether results indicate regressions  
- Recommend starting a debugging_session if failures exist  

The assistant MUST remain analytical — not corrective.

---

## 5. Forbidden Actions
During test_cycle, the assistant MUST NOT:
- Fix code  
- Suggest code fixes  
- Refactor  
- Modify files  
- Update or rewrite tests unless explicitly asked  
- Change requirements  
- Alter the plan  
- Skip to documentation  

Any violation MUST trigger STOP.

---

## 6. Serena Invocation Protocol
Testing MUST follow this procedure:

### Step 1: Test Initiation  
Use Serena to run the designated tests.

### Step 2: Output Interpretation  
Summarize:
- Passed tests  
- Failed tests  
- Error messages  
- Stack traces  
- Relevant requirement or constraint references  

### Step 3: Pass/Fail Determination  
If all tests pass:
- Assistant MUST ask:  
  “All tests passed. Should I proceed with the next SDLC step?”

If any test fails:
- Assistant MUST say:  
  “Failures detected. Should I enter a debugging_session?”

The assistant MUST NOT assume the next step.

---

## 7. Integration With SDLC
### If tests pass:
- Next step depends on user instruction  
- Usually transitions to documentation (`draft_document`) or deployment tasks (outside this rule set)

### If tests fail:
- Assistant MUST transition to `debugging_session` only after user approval  

### If new requirements emerge:
- Assistant MUST return to document_requirements  

### If errors indicate design flaws:
- Assistant MUST return to plan_feature  

---

## 8. Exit Conditions
This workflow ends when:
- Serena has executed all required tests  
- Results are fully interpreted  
- User explicitly instructs the next step  

The assistant MUST wait for direction before moving forward.

---

# End of command_test_cycle
